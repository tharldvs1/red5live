<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009"
			   xmlns:s="library://ns.adobe.com/flex/spark"
			   xmlns:mx="library://ns.adobe.com/flex/mx"
			   minWidth="800"
			   minHeight="700"
			   applicationComplete="init()">
	<s:layout>
		<s:BasicLayout/>
	</s:layout>
	<fx:Declarations>
		<!-- 将非可视元素（例如服务、值对象）放在此处 -->
	</fx:Declarations>

	<fx:Script>
		<![CDATA[
			import flash.display.*;
			import flash.events.*;
			import flash.media.Camera;
			import flash.media.Video;
			import flash.net.*;
			import flash.utils.*;
			
			import mx.controls.Alert;
			import mx.core.IVisualElement;

			private var nc:NetConnection;

			private function init():void
			{
				//Alert.show("先填入服务器地址");
				
				ti.text = Statics.serverIP;
			}


			private function playHandler(event:MouseEvent):void
			{
				if (ti.text == null || ti.text == "")
				{
					Alert.show("先填入服务器地址");
				}
				else
				{
					nc=new NetConnection();
					nc.addEventListener(NetStatusEvent.NET_STATUS, connectHandler);
					nc.client=this;
					nc.connect("rtmp://" + ti.text + "/oflaDemo");
				}
			}


			private function connectHandler(evt:NetStatusEvent):void
			{
				
				/**
				 * NetStream.Play.UnpublishNotify  流取消
				 * 
				 */ 
				
				Test.t(evt.info.code);
				
				if (evt.info.code == "NetConnection.Connect.Success")
				{
					
					var ns:NetStream=new NetStream(nc);
					//ns.client = new CustomClient;
					ns.addEventListener(NetStatusEvent.NET_STATUS, connectHandler);
					
					var video:Video=new Video();
					video.width=Statics.clientWidth;
					video.height=Statics.clientHeight;
					video.attachNetStream(ns);
					ns.play("red5live");
					videoDisplay.addChild(video);
					
					playBtn.mouseEnabled=false;
					
					//Test.t(ns.objectEncoding);
					
					
					
					
					//videoDisplay.source = "rtmp://" + ti.text + "/oflaDemo/red5";
				}
				else
				{
					
					//Alert.show("服务器连接失败");
					//Test.t(evt.info.code);
				}
				
				

			}

			public function onBWDone():void
			{

			}
		]]>
	</fx:Script>


	<s:VGroup>
		<s:Label text="先填入服务器地址" />
		<s:TextInput id="ti"
					 width="200"
					 text=""/>
		<s:Button id="playBtn"
				  label="play"
				  click="playHandler(event)"/>
		<s:VideoDisplay id="videoDisplay" />
	</s:VGroup>

</s:Application>
